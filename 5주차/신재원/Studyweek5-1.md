사용자 요청의 처리 흐름 

1. 웹 또는 모바일 단말(클라이언트)이 DNS 접속

2. DNS 접속 결과로 IP 주소 반환 , 해당 주소로 HTTP 요청 

3. 요청 받은 웹 서버는 응답 반환 ( 정상 혹은 오류 )

사용자가 많아지면 여러 서버를 두어야 한다. 

웹/모바일 트래픽 처리 서버와 데이터베이스 서버


서버의 수평적 규모 확장 & 수직적 규모 확장 


수직적 규모 확장에는 한계와 단순함이 있다.

이런 단점은 응답 속도 저하 및 서버 접속 불가로 이어진다 

이는 부하 분산 또는 로드 밸런서를 도입하는 등 수평적 규모확장으로 해결해야한다. 


로드 밸런서 

로드 밸런서는 부하 분산 집합에 속한 웹 서버에 트래픽 부하를 고르게 분산하는 역할을 한다 

사용자는 로드밸런서의 공개 IP 주소로 접속한다. (웹 서버는 클라이언트의 접속을 직접 처리 X) 

로드밸런서는 또한 서버와 서버간 통신 (LAN) 사설 IP 주소가 이용된다.

-> 웹 계층의 가용성 향상 


데이터베이스 다중화 

만흥ㄴ 데이터베이스 관리 시스템이 다중화를 지원함 

서버 사이 주-부 관계 설정, 원본은 주 서버에 , 사본은 부 서버에 저장 

쓰기 연산은 마스터에서만 지원 , 부 서버는 사본을 전달받고 읽기만을 지원 

파괴적 연산 - insert delete update  - 주 베이스에서만 

대부분의 애플리케이션은 읽기 연산의 비중이 쓰기 연산 보다 훨씬 높다 

따라서 주 데이터베이스의 수보다 부 데이터베이스의 수가 더 많다. 

상황에 따라 주 데이터베이스도 부 데이터베이스가 될 수도 있음 . 


응답 시간 개선 

캐시를 붙이고 정적 컨텐츠를 컨텐츠 전송 네트워크 (CDN) 으로 옮기면 개선 할 수 있다. 

1. 캐시 

자주 참조되는 데이터를 메모리 안에 두고, 뒤이은 요청이 보단 빨리 처리될 수 있도록 하는 저장소 

웹 : 클라이언트의 웹 브라우저에 있거나 , 클라이언트와 서버 사이의 리버스 프록시 서버 또는  CDN(캐시 서버) 또는 분산 캐시(memcahced or redis) 에 위치 

캐시 서버 사용을 통해 데이터 전송 속도를 높이는 역할 - 분산 캐싱 

캐시 서버 또한 한 대만 두는 경우 단일 장애 지점이 될 가능성이 있다. 

2. CDN - 콘텐츠 전송 네트워크 

정적 컨텐츠 ( 이미지 비디오 css js ) 를 전송하는데 쓰이는 지리적으로 분산된 서버의 네트워크 

동적 컨텐츠 ( 사용자의 요청에 따라 실시간으로 정보가 바뀌는 컨텐츠 ) 캐싱은 범위 밖 

++ 1. 템플릿 캐싱 

++ 2. 데이터 캐싱 

++ 3. HTTP 헤더 활용 

CDN은 내가 설정하지 않으면 알아서 접근되지 않는다. CDN을 사용하려면 웹사이트 소유자가 직접 설정해야 합니다.

CDN 설정 과정

CDN 서비스 가입: AWS CloudFront, Cloudflare, Akamai와 같은 CDN 서비스 제공업체에 가입해야 합니다.

원본 서버(Origin Server) 연결: CDN 설정 과정에서 내가 운영하는 웹사이트의 실제 서버(원본 서버) 주소를 CDN에 등록해야 합니다. CDN은 이 원본 서버로부터 콘텐츠를 가져와 캐싱합니다.

DNS 설정 변경: 사용자가 내 웹사이트에 접속할 때, CDN을 거쳐서 콘텐츠를 받아보도록 DNS(Domain Name System) 설정을 변경해야 합니다. 일반적으로 웹사이트의 도메인 주소(예: www.example.com)가 CDN 서버를 가리키도록 CNAME 레코드를 추가하게 됩니다.


무상태 (Stateless) 웹 계층 

웹 계층을 수평적으로 확장하는 방법을 고민해 볼 순서. 

사용자 세션 데이터와 같은 상태 정보를 웹 계층에서 제거하는 것 

상태 정보를 보관하는 서버와 그렇지 않은 서버 사이에는 몇 가지 중요한 차이가 있다. 

사용자 정보를 보관하는 서버가 분산된 경우 그 정보들은 공유되어야 한다. 


웹사이트에서 **메트릭(metrics)**은 웹사이트의 성능, 사용자 행동, 비즈니스 성과 등을 측정하는 데 사용되는 정량적인 데이터입니다. 메트릭은 웹사이트의 현재 상태를 파악하고, 문제점을 찾아 개선하는 데 필수적인 도구

• 메트릭: 메트릭을 잘 수집하면 사업 현황에 관한 유용한 정보를 얻을 수도있고, 시스템의 현재 상태를 손쉽게 파악할 수도 있다. 메트릭 가운데 특히 유용한 것을 몇 가지 살펴보면 다음과 같다.

。호스트 단위 메트릭: CPU, 메모리, 디스크 I/O에 관한 메트릭이 여기 해당한다.

。종합(aggregated) 메트릭: 데이터베이스 계층의 성능, 캐시 계층의 성능같은 것이 여기 해당한다.

。핵심 비즈니스 메트릭: 일별 능동 사용자(daily active user), 수익(revenue), 재방문(retention) 같은 것이 여기 해당한다.
